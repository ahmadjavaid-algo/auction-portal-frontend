<div class="change-password-page">

  <!-- Hero Header -->
  <div class="hero-card animate-on-scroll" style="animation-delay: 0ms">
    <div class="hero-icon">
      <mat-icon>lock_reset</mat-icon>
    </div>
    <h1>Update Your Password</h1>
    <p class="hero-subtitle">
      For security purposes, please enter your current password and set a new one.
    </p>
  </div>

  <!-- Password Form Card -->
  <div class="form-card animate-on-scroll" style="animation-delay: 100ms">
    <form #f="ngForm" (ngSubmit)="submit(f)" class="password-form">

      <!-- Current Password Section -->
      <div class="form-section">
        <div class="section-header">
          <div class="section-icon">
            <mat-icon>verified_user</mat-icon>
          </div>
          <div class="section-text">
            <h2>Security Verification</h2>
            <p>We verify your identity using your current password</p>
          </div>
        </div>

        <div class="form-field">
          <label class="field-label">
            <mat-icon>lock</mat-icon>
            <span>Current Password</span>
          </label>
          <div class="input-wrapper">
            <input
              [type]="showCurrentPassword ? 'text' : 'password'"
              name="currentPassword"
              [(ngModel)]="currentPassword"
              required
              autocomplete="current-password"
              placeholder="Enter your current password"
              class="form-input"
            />
            <button
              type="button"
              class="toggle-visibility"
              (click)="togglePasswordVisibility('current')"
              tabindex="-1"
            >
              <mat-icon>{{ showCurrentPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
          </div>
        </div>
      </div>

      <div class="section-divider"></div>

      <!-- New Password Section -->
      <div class="form-section">
        <div class="section-header">
          <div class="section-icon">
            <mat-icon>key</mat-icon>
          </div>
          <div class="section-text">
            <h2>Set a New Password</h2>
            <p>Your new password must be at least 6 characters long and different from your current one</p>
          </div>
        </div>

        <div class="form-field">
          <label class="field-label">
            <mat-icon>password</mat-icon>
            <span>New Password</span>
          </label>
          <div class="input-wrapper">
            <input
              [type]="showNewPassword ? 'text' : 'password'"
              name="newPassword"
              [(ngModel)]="newPassword"
              required
              minlength="6"
              autocomplete="new-password"
              placeholder="Enter a strong password"
              class="form-input"
            />
            <button
              type="button"
              class="toggle-visibility"
              (click)="togglePasswordVisibility('new')"
              tabindex="-1"
            >
              <mat-icon>{{ showNewPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
          </div>
        </div>

        <div class="form-field">
          <label class="field-label">
            <mat-icon>check_circle</mat-icon>
            <span>Confirm New Password</span>
          </label>
          <div class="input-wrapper">
            <input
              [type]="showConfirmPassword ? 'text' : 'password'"
              name="confirmPassword"
              [(ngModel)]="confirmPassword"
              required
              minlength="6"
              autocomplete="new-password"
              placeholder="Re-enter the new password"
              class="form-input"
            />
            <button
              type="button"
              class="toggle-visibility"
              (click)="togglePasswordVisibility('confirm')"
              tabindex="-1"
            >
              <mat-icon>{{ showConfirmPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
          </div>
        </div>

        <!-- Password Requirements -->
        <div class="password-requirements">
          <div class="requirement-item" [class.met]="newPassword.length >= 6">
            <mat-icon>{{ newPassword.length >= 6 ? 'check_circle' : 'radio_button_unchecked' }}</mat-icon>
            <span>At least 6 characters</span>
          </div>
          <div class="requirement-item" [class.met]="newPassword && confirmPassword && newPassword === confirmPassword">
            <mat-icon>{{ (newPassword && confirmPassword && newPassword === confirmPassword) ? 'check_circle' : 'radio_button_unchecked' }}</mat-icon>
            <span>Passwords match</span>
          </div>
        </div>
      </div>

      <!-- Security Tips -->
      <div class="security-tips animate-on-scroll" style="animation-delay: 200ms">
        <div class="tips-header">
          <mat-icon>tips_and_updates</mat-icon>
          <span>Security Tips</span>
        </div>
        <ul class="tips-list">
          <li>Use a mix of uppercase, lowercase, numbers, and symbols</li>
          <li>Avoid using personal information or common words</li>
          <li>Don't reuse passwords from other accounts</li>
        </ul>
      </div>

      <!-- Form Actions -->
      <div class="form-actions animate-on-scroll" style="animation-delay: 250ms">
        <button
          type="button"
          mat-stroked-button
          class="cancel-btn"
          (click)="cancel()"
          [disabled]="saving"
        >
          <mat-icon>arrow_back</mat-icon>
          <span>Cancel</span>
        </button>

        <button
          type="submit"
          mat-flat-button
          color="primary"
          class="submit-btn"
          [disabled]="saving || f.invalid"
        >
          <mat-progress-spinner
            *ngIf="saving"
            diameter="20"
            mode="indeterminate"
          ></mat-progress-spinner>
          <ng-container *ngIf="!saving">
            <mat-icon>lock</mat-icon>
            <span>Save Password</span>
          </ng-container>
        </button>
      </div>

    </form>
  </div>

</div>