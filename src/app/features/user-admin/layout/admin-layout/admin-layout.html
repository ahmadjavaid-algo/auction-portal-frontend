<div class="layout-container">
  <!-- Sidebar -->
  <aside [class.collapsed]="sidebarCollapsed" class="sidebar">
    <div class="logo">
      <a
        routerLink="dashboard"
        style="display:flex;align-items:center;gap:10px;text-decoration:none;color:white"
      >
        <img
          src="https://media.licdn.com/dms/image/v2/C560BAQGJ-j7r23Z79Q/company-logo_200_200/company-logo_200_200/0/1656698792543/algoai_logo?e=2147483647&v=beta&t=QaHGa0R70yu1J352TZfGUk4z2PUigcta-pMyLIznFG8"
          alt="Logo"
        />
        <span *ngIf="!sidebarCollapsed">Auction Portal</span>
      </a>
    </div>

    <button class="toggle-btn" (click)="toggleSidebar()">
      <span class="material-icons">{{ sidebarCollapsed ? 'menu' : 'close' }}</span>
    </button>

    <nav>
      <a
        routerLink="dashboard"
        routerLinkActive="active"
        [routerLinkActiveOptions]="{ exact: true }"
      >
        <mat-icon>space_dashboard</mat-icon>
        <span class="label" *ngIf="!sidebarCollapsed">Dashboard</span>
      </a>
      <a routerLink="users" routerLinkActive="active">
        <mat-icon>people</mat-icon>
        <span class="label" *ngIf="!sidebarCollapsed">Users</span>
      </a>

      <a routerLink="roles" routerLinkActive="active">
        <mat-icon>admin_panel_settings</mat-icon>
        <span class="label" *ngIf="!sidebarCollapsed">Roles</span>
      </a>

      <a routerLink="inspectors" routerLinkActive="active">
        <mat-icon>verified_user</mat-icon>
        <span class="label" *ngIf="!sidebarCollapsed">Inspectors</span>
      </a>
      <a routerLink="bidders" routerLinkActive="active">
        <mat-icon>gavel</mat-icon>
        <span class="label" *ngIf="!sidebarCollapsed">Bidders</span>
      </a>
      <a routerLink="emails" routerLinkActive="active">
        <mat-icon>mail</mat-icon>
        <span class="label" *ngIf="!sidebarCollapsed">Emails</span>
      </a>
      <a routerLink="make" routerLinkActive="active">
        <mat-icon>directions_car</mat-icon>
        <span class="label" *ngIf="!sidebarCollapsed">Product Configuration</span>
      </a>
      <a routerLink="products" routerLinkActive="active">
        <mat-icon>category</mat-icon>
        <span class="label" *ngIf="!sidebarCollapsed">Products</span>
      </a>

      <a routerLink="inventory" routerLinkActive="active">
        <mat-icon>inventory_2</mat-icon>
        <span class="label" *ngIf="!sidebarCollapsed">Inventory</span>
      </a>
      <a routerLink="auctions" routerLinkActive="active">
        <mat-icon>price_change</mat-icon>
        <span class="label" *ngIf="!sidebarCollapsed">Auctions</span>
      </a>
      <a routerLink="inspection" routerLinkActive="active">
        <mat-icon>fact_check</mat-icon>
        <span class="label" *ngIf="!sidebarCollapsed">Inspection</span>
      </a>
    </nav>
  </aside>

  <!-- Main -->
  <main class="main-content">
    <header class="topbar">
      <!-- Notifications -->
      <div #notifHost class="notif-wrapper">
        <button
          class="icon-btn"
          aria-label="Notifications"
          (click)="toggleNotifications()"
        >
          <mat-icon>notifications</mat-icon>
          <span class="dot" *ngIf="unreadCount > 0"></span>
        </button>

        <div class="notif-panel" *ngIf="notifOpen">
          <div class="notif-header">
            <span>Notifications</span>
            <div class="right">
              <span class="badge" *ngIf="unreadCount > 0">
                {{ unreadCount }} new
              </span>
              <button
                type="button"
                class="clear-btn"
                *ngIf="notifications.length"
                (click)="clearNotifications($event)"
              >
                Clear all
              </button>
            </div>
          </div>

          <div class="notif-list" *ngIf="notifications.length; else noAdminNotif">
            <button
              type="button"
              class="notif-item"
              *ngFor="let n of notifications"
              (click)="onNotificationClick(n)"
            >
              <div class="notif-main">
                <div class="title">
                  {{ n.title }}
                  <span class="pill" *ngIf="!n.read">NEW</span>
                </div>
                <div class="msg">{{ n.message }}</div>
              </div>
              <div class="time">
                {{ n.createdAt | date: 'shortTime' }}
              </div>
            </button>
          </div>

          <ng-template #noAdminNotif>
            <div class="notif-empty">
              <mat-icon>notifications_none</mat-icon>
              <span>No notifications yet.</span>
            </div>
          </ng-template>
        </div>
      </div>

      <!-- User dropdown -->
      <div
        #dropdown
        class="user"
        [class.open]="dropdownOpen"
        (click)="toggleDropdown()"
      >
        <div class="avatar">{{ (displayName || 'U') | slice: 0:1 }}</div>
        <span class="name">{{ displayName }}</span>
        <mat-icon>expand_more</mat-icon>
        <ul>
          <li><a (click)="changePassword()">Change Password</a></li>
          <li><a (click)="logout()">Logout</a></li>
        </ul>
      </div>
    </header>

    <!-- Routed Content -->
    <router-outlet></router-outlet>
  </main>
</div>
