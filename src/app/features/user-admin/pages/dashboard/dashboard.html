<div class="dashboard-container">
  <!-- Hero Section -->
  <section class="hero-banner reveal-on-scroll">
    <div class="hero-background">
      <div class="hero-gradient"></div>
      <div class="hero-pattern"></div>
    </div>
    
    <div class="hero-content">
      <div class="hero-text">
        <div class="hero-greeting">
          <span class="greeting-label">Welcome back,</span>
          <h1 class="admin-name">{{ adminName }}</h1>
        </div>
        <p class="hero-description">
          Your luxury auction command center — Real-time insights and performance metrics at a glance
        </p>
        <div class="hero-meta">
          <span class="meta-item">
            <mat-icon>schedule</mat-icon>
            Live Data
          </span>
          <span class="meta-separator">·</span>
          <span class="meta-item">
            <mat-icon>verified</mat-icon>
            {{ liveAuctionCount }} Active Auctions
          </span>
          <span class="meta-separator">·</span>
          <span class="meta-item">
            <mat-icon>trending_up</mat-icon>
            {{ bidsToday }} Bids Today
          </span>
        </div>
      </div>
      
      <div class="hero-actions">
        <button mat-flat-button class="hero-btn primary">
          <mat-icon>add_circle</mat-icon>
          <span>List New Vehicle</span>
        </button>
        <button mat-stroked-button class="hero-btn secondary">
          <mat-icon>event_note</mat-icon>
          <span>Schedule Auction</span>
        </button>
      </div>
    </div>
    
    <div class="hero-stats-bar">
      <div class="quick-stat">
        <mat-icon class="stat-icon">local_fire_department</mat-icon>
        <div class="stat-data">
          <span class="stat-value">{{ liveAuctionCount }}</span>
          <span class="stat-label">Live Now</span>
        </div>
      </div>
      
      <div class="stat-divider"></div>
      
      <div class="quick-stat">
        <mat-icon class="stat-icon">attach_money</mat-icon>
        <div class="stat-data">
          <span class="stat-value">${{ (totalRevenue / 1000) | number:'1.0-0' }}K</span>
          <span class="stat-label">Total Revenue</span>
        </div>
      </div>
      
      <div class="stat-divider"></div>
      
      <div class="quick-stat">
        <mat-icon class="stat-icon">groups</mat-icon>
        <div class="stat-data">
          <span class="stat-value">{{ totalBidders }}</span>
          <span class="stat-label">Registered Bidders</span>
        </div>
      </div>
      
      <div class="stat-divider"></div>
      
      <div class="quick-stat success">
        <mat-icon class="stat-icon">trending_up</mat-icon>
        <div class="stat-data">
          <span class="stat-value">+{{ revenueChangePercent }}%</span>
          <span class="stat-label">Growth</span>
        </div>
      </div>
    </div>
  </section>

  <!-- Primary KPI Grid -->
  <section class="kpi-grid reveal-on-scroll">
    <div class="kpi-card" *ngFor="let s of stats; let i = index" [style.--delay]="i * 0.05 + 's'">
      <div class="kpi-header">
        <div class="kpi-icon-wrapper">
          <mat-icon [class.pulse]="s.key === 'Live Auction'">{{ s.icon }}</mat-icon>
        </div>
        <span class="kpi-change" [class.positive]="s.up" [class.negative]="!s.up">
          <mat-icon>{{ s.up ? 'arrow_upward' : 'arrow_downward' }}</mat-icon>
          {{ s.delta }}
        </span>
      </div>
      
      <div class="kpi-body">
        <div class="kpi-value count-up" [attr.data-value]="s.value">{{ s.value }}</div>
        <div class="kpi-label">{{ s.label }}</div>
      </div>
    </div>
  </section>

  <!-- Analytics Grid -->
  <section class="analytics-grid">
    <!-- Revenue Chart -->
    <div class="chart-panel revenue-panel reveal-on-scroll">
      <div class="panel-header">
        <div>
          <h3>Revenue Trend</h3>
          <p class="panel-subtitle">Last 12 months performance</p>
        </div>
        <div class="header-metrics">
          <div class="metric-pill positive">
            <mat-icon>trending_up</mat-icon>
            <span>+{{ revenueChangePercent }}%</span>
          </div>
        </div>
      </div>
      
      <div class="chart-container">
        <canvas #revenueCanvas width="800" height="300"></canvas>
      </div>
      
      <div class="chart-footer">
        <div class="footer-stat">
          <span class="label">Current Month</span>
          <span class="value">${{ revenueToday | number : '1.0-0' }}</span>
        </div>
        <div class="footer-stat">
          <span class="label">Average</span>
          <span class="value">${{ (totalRevenue / 12) | number : '1.0-0' }}</span>
        </div>
        <div class="footer-stat">
          <span class="label">Projected</span>
          <span class="value">${{ (totalRevenue * 1.15) | number : '1.0-0' }}</span>
        </div>
      </div>
    </div>

    <!-- Bids Chart -->
    <div class="chart-panel bids-panel reveal-on-scroll">
      <div class="panel-header">
        <div>
          <h3>Bid Activity</h3>
          <p class="panel-subtitle">Monthly bid volume</p>
        </div>
        <div class="header-metrics">
          <div class="metric-pill info">
            <mat-icon>gavel</mat-icon>
            <span>{{ bidsToday }}</span>
          </div>
        </div>
      </div>
      
      <div class="chart-container">
        <canvas #bidsCanvas width="400" height="250"></canvas>
      </div>
      
      <div class="chart-stats">
        <div class="stat-item">
          <span class="stat-value">{{ (bidsToday / liveAuctionCount) | number : '1.0-0' }}</span>
          <span class="stat-label">Avg per Auction</span>
        </div>
        <div class="stat-item">
          <span class="stat-value">{{ bidsChangePercent }}%</span>
          <span class="stat-label">Growth Rate</span>
        </div>
      </div>
    </div>

    <!-- Live Auctions Table -->
    <div class="data-panel auctions-panel reveal-on-scroll">
      <div class="panel-header">
        <div>
          <h3>Active Auctions</h3>
          <p class="panel-subtitle">{{ liveAuctions.length }} live · Real-time updates</p>
        </div>
        <button mat-icon-button *ngIf="liveAuctions.length > 6" (click)="toggleGlance()">
          <mat-icon>{{ glanceExpanded ? 'expand_less' : 'expand_more' }}</mat-icon>
        </button>
      </div>
      
      <div class="panel-loader" *ngIf="glanceLoading">
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
      </div>
      
      <div class="data-table" *ngIf="!glanceLoading && liveAuctions.length">
        <table>
          <thead>
            <tr>
              <th>LOT ID</th>
              <th>MANUFACTURER</th>
              <th>UNITS</th>
              <th>STATUS</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let a of visibleGlanceAuctions" class="table-row">
              <td class="mono-cell">{{ a.lot }}</td>
              <td class="bold-cell">{{ a.make }}</td>
              <td class="number-cell">
                <span class="unit-badge">{{ a.count }}</span>
              </td>
              <td>
                <span class="status-badge" 
                      [class.live]="a.status === 'Live'"
                      [class.scheduled]="a.status === 'Scheduled'">
                  {{ a.status }}
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <div *ngIf="!glanceLoading && !liveAuctions.length" class="empty-panel">
        <mat-icon>event_busy</mat-icon>
        <span>No active auctions</span>
      </div>
    </div>

    <!-- Distribution Chart -->
    <div class="chart-panel distribution-panel reveal-on-scroll">
      <div class="panel-header">
        <div>
          <h3>Inventory Distribution</h3>
          <p class="panel-subtitle">By manufacturer</p>
        </div>
      </div>
      
      <div class="chart-container donut-container">
        <canvas #distributionCanvas width="300" height="300"></canvas>
      </div>
      
      <div class="legend-list">
        <div class="legend-item" *ngFor="let item of auctionMakeSummary.slice(0, 5); let i = index">
          <span class="legend-color" [style.background]="['#D4AF37', '#1e3a8a', '#059669', '#dc2626', '#7c3aed'][i]"></span>
          <span class="legend-label">{{ item.make }}</span>
          <span class="legend-value">{{ item.count }}</span>
        </div>
      </div>
    </div>

    <!-- Verification Queue -->
    <div class="data-panel verification-panel reveal-on-scroll">
      <div class="panel-header">
        <div>
          <h3>KYC Verification</h3>
          <p class="panel-subtitle">{{ unverifiedBidders.length }} pending review</p>
        </div>
        <button mat-icon-button (click)="loadUnverifiedBidders()" matTooltip="Refresh">
          <mat-icon>refresh</mat-icon>
        </button>
      </div>
      
      <div class="panel-loader" *ngIf="kycLoading">
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
      </div>
      
      <div class="verification-list" *ngIf="!kycLoading && unverifiedBidders.length">
        <div class="verification-item" *ngFor="let u of unverifiedBidders.slice(0, 5)">
          <div class="user-avatar">{{ getFullName(u) | slice:0:1 }}</div>
          <div class="user-details">
            <div class="user-name">{{ getFullName(u) }}</div>
            <div class="user-email">{{ u.email || u.userName }}</div>
          </div>
          <span class="time-badge">{{ toRelative(u.createdDate) }}</span>
        </div>
      </div>
      
      <div class="verification-stats" *ngIf="!kycLoading && totalBidders > 0">
        <div class="progress-bar-container">
          <div class="progress-bar-fill" [style.width.%]="verificationRate"></div>
        </div>
        <div class="stats-row">
          <span class="stat"><strong>{{ verificationRate }}%</strong> Verified</span>
          <span class="stat">{{ verifiedBidders }}/{{ totalBidders }}</span>
        </div>
      </div>
      
      <div *ngIf="!kycLoading && !unverifiedBidders.length" class="empty-panel success">
        <mat-icon>verified</mat-icon>
        <span>All verified</span>
      </div>
    </div>

    <!-- Top Bidders -->
    <div class="data-panel bidders-panel reveal-on-scroll">
      <div class="panel-header">
        <div>
          <h3>Top Bidders Today</h3>
          <p class="panel-subtitle">Most active participants</p>
        </div>
      </div>
      
      <div class="panel-loader" *ngIf="topBiddersLoading">
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
      </div>
      
      <div class="leaderboard" *ngIf="!topBiddersLoading && topBidders.length">
        <div class="leaderboard-item" *ngFor="let b of topBidders; let i = index">
          <div class="rank-badge" [class.gold]="i === 0" [class.silver]="i === 1" [class.bronze]="i === 2">
            {{ i + 1 }}
          </div>
          <div class="bidder-info">
            <div class="bidder-name">{{ b.name }}</div>
            <div class="bidder-handle">{{ b.handle }}</div>
          </div>
          <div class="bid-count">
            <mat-icon>gavel</mat-icon>
            <span>{{ b.bids }}</span>
          </div>
        </div>
      </div>
      
      <div *ngIf="!topBiddersLoading && !topBidders.length" class="empty-panel">
        <mat-icon>emoji_events</mat-icon>
        <span>No bids today</span>
      </div>
    </div>

    <!-- Recent Activity -->
    <div class="data-panel activity-panel reveal-on-scroll">
      <div class="panel-header">
        <div>
          <h3>Activity Feed</h3>
          <p class="panel-subtitle">Real-time updates</p>
        </div>
        <button mat-icon-button (click)="toggleRecentActivity()">
          <mat-icon>{{ activityCollapsed ? 'unfold_more' : 'unfold_less' }}</mat-icon>
        </button>
      </div>
      
      <div class="panel-loader" *ngIf="activityLoading">
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
      </div>
      
      <div class="activity-feed" *ngIf="!activityLoading && activity.length">
        <div class="activity-item" *ngFor="let a of (activityCollapsed ? activity.slice(0, 5) : activity)">
          <div class="activity-icon">
            <mat-icon>{{ a.icon }}</mat-icon>
          </div>
          <div class="activity-content">
            <p class="activity-text">{{ a.text }}</p>
            <span class="activity-time">{{ a.time }}</span>
          </div>
        </div>
      </div>
      
      <div *ngIf="!activityLoading && !activity.length" class="empty-panel">
        <mat-icon>notifications_none</mat-icon>
        <span>No recent activity</span>
      </div>
    </div>

    <!-- Bidder Funnel -->
    <div class="data-panel funnel-panel reveal-on-scroll">
      <div class="panel-header">
        <div>
          <h3>User Funnel</h3>
          <p class="panel-subtitle">Registration to verification</p>
        </div>
      </div>
      
      <div class="funnel-content" *ngIf="totalBidders > 0">
        <div class="funnel-stage">
          <div class="stage-bar">
            <div class="stage-fill" [style.width.%]="100"></div>
          </div>
          <div class="stage-info">
            <span class="stage-label">Total Registrations</span>
            <span class="stage-value">{{ totalBidders }}</span>
          </div>
        </div>
        
        <div class="funnel-stage">
          <div class="stage-bar verified">
            <div class="stage-fill" [style.width.%]="verificationRate"></div>
          </div>
          <div class="stage-info">
            <span class="stage-label">Verified Users</span>
            <span class="stage-value">{{ verifiedBidders }}</span>
          </div>
        </div>
        
        <div class="funnel-metrics-grid">
          <div class="metric-box">
            <mat-icon class="pending">pending</mat-icon>
            <div>
              <div class="metric-number">{{ unverifiedBidders.length }}</div>
              <div class="metric-text">Pending</div>
            </div>
          </div>
          
          <div class="metric-box">
            <mat-icon class="new">person_add</mat-icon>
            <div>
              <div class="metric-number">{{ recentSignups7d }}</div>
              <div class="metric-text">New (7d)</div>
            </div>
          </div>
        </div>
      </div>
      
      <div *ngIf="totalBidders === 0" class="empty-panel">
        <mat-icon>group_add</mat-icon>
        <span>No users yet</span>
      </div>
    </div>
  </section>
</div>