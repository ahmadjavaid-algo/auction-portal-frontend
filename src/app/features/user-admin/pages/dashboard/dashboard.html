<div class="dashboard-container">
  <!-- Full-Width Hero Section -->
  <section class="dashboard-hero reveal-on-scroll">
    <div class="hero-background">
      <div class="hero-gradient"></div>
      <div class="hero-pattern"></div>
    </div>
    
    <div class="hero-content-wrapper">
      <div class="hero-main-content">
        <div class="hero-text-section">
          <div class="hero-badge">
            <mat-icon>dashboard</mat-icon>
            <span>Admin Dashboard</span>
          </div>
          <div class="hero-greeting">
            <span class="greeting-label">Welcome back,</span>
            <h1 class="admin-name">{{ adminName }}</h1>
          </div>
          <p class="hero-description">
            Your luxury auction command center — Real-time insights, performance metrics, and comprehensive analytics
          </p>
        </div>
        
        <div class="hero-actions">
          <button mat-flat-button class="hero-btn primary">
            <mat-icon>add_circle</mat-icon>
            <span>List New Vehicle</span>
          </button>
          <button mat-stroked-button class="hero-btn secondary">
            <mat-icon>event_note</mat-icon>
            <span>Schedule Auction</span>
          </button>
        </div>
      </div>

      <!-- Integrated Hero Stats -->
      <div class="hero-stats-grid">
        <div class="hero-stat-card live">
          <div class="stat-icon-wrapper">
            <mat-icon class="pulse-icon">local_fire_department</mat-icon>
          </div>
          <div class="stat-details">
            <div class="stat-value">{{ animatedHeroStats.liveAuctions }}</div>
            <div class="stat-label">Live Auctions</div>
          </div>
          <div class="stat-decoration"></div>
        </div>

        <div class="hero-stat-card revenue">
          <div class="stat-icon-wrapper">
            <mat-icon>attach_money</mat-icon>
          </div>
          <div class="stat-details">
            <div class="stat-value">{{ formatCurrency(animatedHeroStats.totalRevenue) }}</div>
            <div class="stat-label">Total Revenue</div>
          </div>
          <div class="stat-decoration"></div>
        </div>

        <div class="hero-stat-card bidders">
          <div class="stat-icon-wrapper">
            <mat-icon>groups</mat-icon>
          </div>
          <div class="stat-details">
            <div class="stat-value">{{ animatedHeroStats.registeredBidders }}</div>
            <div class="stat-label">Registered Bidders</div>
          </div>
          <div class="stat-decoration"></div>
        </div>

        <div class="hero-stat-card growth">
          <div class="stat-icon-wrapper">
            <mat-icon>trending_up</mat-icon>
          </div>
          <div class="stat-details">
            <div class="stat-value">+{{ animatedHeroStats.growthPercent }}%</div>
            <div class="stat-label">Revenue Growth</div>
          </div>
          <div class="stat-decoration"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- Primary KPI Grid -->
  <section class="kpi-grid reveal-on-scroll">
    <div class="kpi-card" 
         *ngFor="let s of stats; let i = index" 
         [class]="'kpi-' + s.color"
         [style.--delay]="i * 0.05 + 's'">
      <div class="kpi-header">
        <div class="kpi-icon-wrapper">
          <mat-icon [class.pulse]="s.key === 'Live Auction'">{{ s.icon }}</mat-icon>
        </div>
        <span class="kpi-change" [class.positive]="s.up" [class.negative]="!s.up">
          <mat-icon>{{ s.up ? 'arrow_upward' : 'arrow_downward' }}</mat-icon>
          {{ s.delta }}
        </span>
      </div>
      
      <div class="kpi-body">
        <div class="kpi-value count-up" [attr.data-value]="s.value">{{ formatNumber(s.value) }}</div>
        <div class="kpi-label">{{ s.label }}</div>
      </div>
      
      <div class="kpi-decoration"></div>
    </div>
  </section>

  <!-- Analytics Grid -->
  <section class="analytics-grid">
    <!-- Revenue Chart -->
    <div class="chart-panel revenue-panel reveal-on-scroll">
      <div class="panel-header">
        <div class="header-left">
          <div class="header-icon">
            <mat-icon>show_chart</mat-icon>
          </div>
          <div>
            <h3>Revenue Trend</h3>
            <p class="panel-subtitle">Last 12 months performance trajectory</p>
          </div>
        </div>
        <div class="header-metrics">
          <div class="metric-pill positive">
            <mat-icon>trending_up</mat-icon>
            <span>+{{ revenueChangePercent }}%</span>
          </div>
        </div>
      </div>
      
      <div class="chart-container">
        <canvas #revenueCanvas width="800" height="280"></canvas>
      </div>
      
      <div class="chart-footer">
        <div class="footer-stat">
          <mat-icon>calendar_today</mat-icon>
          <div>
            <span class="label">This Month</span>
            <span class="value">{{ formatCurrency(revenueToday) }}</span>
          </div>
        </div>
        <div class="footer-divider"></div>
        <div class="footer-stat">
          <mat-icon>timeline</mat-icon>
          <div>
            <span class="label">Monthly Avg</span>
            <span class="value">{{ formatCurrency(totalRevenue / 12) }}</span>
          </div>
        </div>
        <div class="footer-divider"></div>
        <div class="footer-stat">
          <mat-icon>insights</mat-icon>
          <div>
            <span class="label">Projected</span>
            <span class="value">{{ formatCurrency(totalRevenue * 1.15) }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Bids Chart -->
    <div class="chart-panel bids-panel reveal-on-scroll">
      <div class="panel-header">
        <div class="header-left">
          <div class="header-icon">
            <mat-icon>gavel</mat-icon>
          </div>
          <div>
            <h3>Bid Activity</h3>
            <p class="panel-subtitle">Monthly bid volume trends</p>
          </div>
        </div>
        <div class="header-metrics">
          <div class="metric-pill info">
            <mat-icon>today</mat-icon>
            <span>{{ bidsToday }} Today</span>
          </div>
        </div>
      </div>
      
      <div class="chart-container">
        <canvas #bidsCanvas width="400" height="240"></canvas>
      </div>
      
      <div class="chart-stats">
        <div class="stat-item">
          <div class="stat-icon">
            <mat-icon>calculate</mat-icon>
          </div>
          <div>
            <span class="stat-value">{{ liveAuctionCount > 0 ? (bidsToday / liveAuctionCount) : 0 | number : '1.0-0' }}</span>
            <span class="stat-label">Avg per Auction</span>
          </div>
        </div>
        <div class="stat-divider"></div>
        <div class="stat-item">
          <div class="stat-icon">
            <mat-icon>percent</mat-icon>
          </div>
          <div>
            <span class="stat-value">{{ bidsChangePercent >= 0 ? '+' : '' }}{{ bidsChangePercent }}%</span>
            <span class="stat-label">Growth Rate</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Live Auctions Table -->
    <div class="data-panel auctions-panel reveal-on-scroll">
      <div class="panel-header">
        <div class="header-left">
          <div class="header-icon">
            <mat-icon>event_available</mat-icon>
          </div>
          <div>
            <h3>Active Auctions</h3>
            <p class="panel-subtitle">{{ liveAuctions.length }} live · Real-time updates</p>
          </div>
        </div>
        <button mat-icon-button *ngIf="liveAuctions.length > 6" (click)="toggleGlance()">
          <mat-icon>{{ glanceExpanded ? 'expand_less' : 'expand_more' }}</mat-icon>
        </button>
      </div>
      
      <div class="panel-loader" *ngIf="glanceLoading">
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
      </div>
      
      <div class="data-table" *ngIf="!glanceLoading && liveAuctions.length">
        <table>
          <thead>
            <tr>
              <th>
                <div class="th-content">
                  <mat-icon>tag</mat-icon>
                  <span>LOT ID</span>
                </div>
              </th>
              <th>
                <div class="th-content">
                  <mat-icon>business</mat-icon>
                  <span>MANUFACTURER</span>
                </div>
              </th>
              <th>
                <div class="th-content">
                  <mat-icon>inventory</mat-icon>
                  <span>UNITS</span>
                </div>
              </th>
              <th>
                <div class="th-content">
                  <mat-icon>show_chart</mat-icon>
                  <span>STATUS</span>
                </div>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let a of visibleGlanceAuctions" class="table-row">
              <td class="mono-cell">{{ a.lot }}</td>
              <td class="bold-cell">{{ a.make }}</td>
              <td class="number-cell">
                <span class="unit-badge">{{ a.count }}</span>
              </td>
              <td>
                <span class="status-badge" 
                      [class.live]="a.status === 'Live'"
                      [class.scheduled]="a.status === 'Scheduled'">
                  <span class="status-dot"></span>
                  {{ a.status }}
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <div *ngIf="!glanceLoading && !liveAuctions.length" class="empty-panel">
        <mat-icon>event_busy</mat-icon>
        <span>No active auctions at this time</span>
      </div>
    </div>

    <!-- Distribution Chart -->
    <div class="chart-panel distribution-panel reveal-on-scroll">
      <div class="panel-header">
        <div class="header-left">
          <div class="header-icon">
            <mat-icon>pie_chart</mat-icon>
          </div>
          <div>
            <h3>Inventory Distribution</h3>
            <p class="panel-subtitle">By manufacturer breakdown</p>
          </div>
        </div>
      </div>
      
      <div class="chart-container donut-container">
        <canvas #distributionCanvas width="280" height="280"></canvas>
      </div>
      
      <div class="legend-list">
        <div class="legend-item" *ngFor="let item of auctionMakeSummary.slice(0, 5); let i = index">
          <span class="legend-color" [style.background]="['#D4AF37', '#1e3a8a', '#059669', '#dc2626', '#7c3aed'][i]"></span>
          <div class="legend-info">
            <span class="legend-label">{{ item.make }}</span>
            <span class="legend-value">{{ item.count }} units</span>
          </div>
          <span class="legend-percent">{{ (item.count / vehiclesListed * 100) | number : '1.0-0' }}%</span>
        </div>
      </div>
    </div>

    <!-- Verification Queue -->
    <div class="data-panel verification-panel reveal-on-scroll">
      <div class="panel-header">
        <div class="header-left">
          <div class="header-icon">
            <mat-icon>verified_user</mat-icon>
          </div>
          <div>
            <h3>KYC Verification</h3>
            <p class="panel-subtitle">{{ unverifiedBidders.length }} pending review</p>
          </div>
        </div>
        <button mat-icon-button (click)="loadUnverifiedBidders()" matTooltip="Refresh">
          <mat-icon>refresh</mat-icon>
        </button>
      </div>
      
      <div class="panel-loader" *ngIf="kycLoading">
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
      </div>
      
      <div class="verification-list" *ngIf="!kycLoading && unverifiedBidders.length">
        <div class="verification-item" *ngFor="let u of unverifiedBidders.slice(0, 5)">
          <div class="user-avatar">{{ getFullName(u) | slice:0:1 }}</div>
          <div class="user-details">
            <div class="user-name">{{ getFullName(u) }}</div>
            <div class="user-email">{{ u.email || u.userName }}</div>
          </div>
          <span class="time-badge">{{ toRelative(u.createdDate) }}</span>
        </div>
      </div>
      
      <div class="verification-stats" *ngIf="!kycLoading && totalBidders > 0">
        <div class="progress-bar-container">
          <div class="progress-bar-fill" [style.width.%]="verificationRate"></div>
        </div>
        <div class="stats-row">
          <span class="stat">
            <mat-icon>verified</mat-icon>
            <strong>{{ verificationRate }}%</strong> Verified
          </span>
          <span class="stat">{{ verifiedBidders }} / {{ totalBidders }}</span>
        </div>
      </div>
      
      <div *ngIf="!kycLoading && !unverifiedBidders.length" class="empty-panel success">
        <mat-icon>check_circle</mat-icon>
        <span>All users verified</span>
      </div>
    </div>

    <!-- Top Bidders -->
    <div class="data-panel bidders-panel reveal-on-scroll">
      <div class="panel-header">
        <div class="header-left">
          <div class="header-icon">
            <mat-icon>emoji_events</mat-icon>
          </div>
          <div>
            <h3>Top Bidders Today</h3>
            <p class="panel-subtitle">Most active participants</p>
          </div>
        </div>
      </div>
      
      <div class="panel-loader" *ngIf="topBiddersLoading">
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
      </div>
      
      <div class="leaderboard" *ngIf="!topBiddersLoading && topBidders.length">
        <div class="leaderboard-item" *ngFor="let b of topBidders; let i = index">
          <div class="rank-badge" [class.gold]="i === 0" [class.silver]="i === 1" [class.bronze]="i === 2">
            <mat-icon *ngIf="i < 3">{{ i === 0 ? 'emoji_events' : (i === 1 ? 'workspace_premium' : 'military_tech') }}</mat-icon>
            <span *ngIf="i >= 3">{{ i + 1 }}</span>
          </div>
          <div class="bidder-info">
            <div class="bidder-name">{{ b.name }}</div>
            <div class="bidder-handle">{{ b.handle }}</div>
          </div>
          <div class="bid-count">
            <mat-icon>gavel</mat-icon>
            <span>{{ b.bids }}</span>
          </div>
        </div>
      </div>
      
      <div *ngIf="!topBiddersLoading && !topBidders.length" class="empty-panel">
        <mat-icon>hourglass_empty</mat-icon>
        <span>No bids recorded today</span>
      </div>
    </div>

    <!-- Recent Activity -->
    <div class="data-panel activity-panel reveal-on-scroll">
      <div class="panel-header">
        <div class="header-left">
          <div class="header-icon">
            <mat-icon>notifications_active</mat-icon>
          </div>
          <div>
            <h3>Activity Feed</h3>
            <p class="panel-subtitle">Real-time platform updates</p>
          </div>
        </div>
        <button mat-icon-button (click)="toggleRecentActivity()">
          <mat-icon>{{ activityCollapsed ? 'unfold_more' : 'unfold_less' }}</mat-icon>
        </button>
      </div>
      
      <div class="panel-loader" *ngIf="activityLoading">
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
      </div>
      
      <div class="activity-feed" *ngIf="!activityLoading && activity.length">
        <div class="activity-item" *ngFor="let a of (activityCollapsed ? activity.slice(0, 5) : activity)">
          <div class="activity-icon">
            <mat-icon>{{ a.icon }}</mat-icon>
          </div>
          <div class="activity-content">
            <p class="activity-text">{{ a.text }}</p>
            <span class="activity-time">{{ a.time }}</span>
          </div>
        </div>
      </div>
      
      <div *ngIf="!activityLoading && !activity.length" class="empty-panel">
        <mat-icon>notifications_none</mat-icon>
        <span>No recent activity</span>
      </div>
    </div>

    <!-- Bidder Funnel -->
    <div class="data-panel funnel-panel reveal-on-scroll">
      <div class="panel-header">
        <div class="header-left">
          <div class="header-icon">
            <mat-icon>filter_alt</mat-icon>
          </div>
          <div>
            <h3>User Conversion Funnel</h3>
            <p class="panel-subtitle">Registration to verification</p>
          </div>
        </div>
      </div>
      
      <div class="funnel-content" *ngIf="totalBidders > 0">
        <div class="funnel-stage">
          <div class="stage-bar total">
            <div class="stage-fill" [style.width.%]="100"></div>
          </div>
          <div class="stage-info">
            <mat-icon>person_add</mat-icon>
            <div>
              <span class="stage-label">Total Registrations</span>
              <span class="stage-value">{{ totalBidders }}</span>
            </div>
          </div>
        </div>
        
        <div class="funnel-stage">
          <div class="stage-bar verified">
            <div class="stage-fill" [style.width.%]="verificationRate"></div>
          </div>
          <div class="stage-info">
            <mat-icon>verified</mat-icon>
            <div>
              <span class="stage-label">Verified Users</span>
              <span class="stage-value">{{ verifiedBidders }}</span>
            </div>
          </div>
        </div>
        
        <div class="funnel-metrics-grid">
          <div class="metric-box pending">
            <mat-icon>pending</mat-icon>
            <div>
              <div class="metric-number">{{ unverifiedBidders.length }}</div>
              <div class="metric-text">Pending Verification</div>
            </div>
          </div>
          
          <div class="metric-box new">
            <mat-icon>fiber_new</mat-icon>
            <div>
              <div class="metric-number">{{ recentSignups7d }}</div>
              <div class="metric-text">New This Week</div>
            </div>
          </div>
        </div>
      </div>
      
      <div *ngIf="totalBidders === 0" class="empty-panel">
        <mat-icon>group_add</mat-icon>
        <span>No registered users yet</span>
      </div>
    </div>
  </section>
</div>