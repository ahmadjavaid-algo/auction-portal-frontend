<form class="dialog-form" [formGroup]="form" (ngSubmit)="submit()">
  <div class="header">
    <h2>Add {{ data.count }} item(s) to an auction</h2>
    <p class="sub">
      Choose a target auction and the initial status. Prices are optional.
      <br />
      <strong>Rule:</strong>
      Only vehicles with
      <span class="highlight">Completed inspection (all checkpoints answered)</span>
      can be added to an auction.
    </p>
  </div>

  <mat-dialog-content class="body">
    <div class="sheet">
      <!-- Inspection completion summary for the selected inventories -->
      <div class="notice" *ngIf="inspectionChecked">
        <mat-icon
          class="notice-icon"
          [ngClass]="{
            ok: allSelectionInspectionCompleted,
            warn: !allSelectionInspectionCompleted
          }"
        >
          {{ allSelectionInspectionCompleted ? 'verified' : 'error_outline' }}
        </mat-icon>

        <div class="notice-text">
          <ng-container *ngIf="allSelectionInspectionCompleted; else notOk">
            <div class="notice-title">Inspections completed</div>
            <div class="notice-sub">
              All selected vehicles have their inspections fully completed (100%).
              You can safely add them to the auction.
            </div>
          </ng-container>

          <ng-template #notOk>
            <div class="notice-title">Inspection incomplete</div>
            <div class="notice-sub">
              Only vehicles with a <strong>Completed</strong> inspection (all checkpoints answered)
              can be added to an auction.
              <br />
              Selected: {{ totalSelected }} item(s),
              Completed: {{ completedCount }} item(s).
              <br />
              Please deselect vehicles whose inspections are not yet completed and try again.
            </div>
          </ng-template>
        </div>
      </div>

      <div class="grid">
        <mat-form-field appearance="outline">
          <mat-label>Auction *</mat-label>
          <mat-select formControlName="auctionId" [disabled]="loadingAuctions">
            <mat-option *ngFor="let a of auctions" [value]="a.auctionId">
              {{ a.auctionName || ('Auction #' + a.auctionId) }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <!-- Uncomment if you want status & prices in this dialog as well
        <mat-form-field appearance="outline">
          <mat-label>Status *</mat-label>
          <mat-select formControlName="inventoryAuctionStatusId">
            <mat-option *ngFor="let s of statuses" [value]="s.id">
              {{ s.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Buy now price</mat-label>
          <input matInput type="number" formControlName="buyNowPrice" min="0" />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Reserve price</mat-label>
          <input matInput type="number" formControlName="reservePrice" min="0" />
        </mat-form-field>
        -->
      </div>
    </div>
  </mat-dialog-content>

  <mat-dialog-actions align="end" class="actions">
    <button mat-stroked-button type="button" (click)="cancel()">Cancel</button>
    <button
      mat-flat-button
      color="primary"
      type="submit"
      [disabled]="
        form.invalid ||
        loadingAuctions ||
        loadingInspection ||
        (inspectionChecked && !allSelectionInspectionCompleted)
      "
    >
      Add
    </button>
  </mat-dialog-actions>
</form>
