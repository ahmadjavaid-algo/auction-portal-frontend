<div class="landing auctions-landing">
  <!-- ✅ DASHBOARD-LIKE FULL BLEED HERO (same typography as auctions-list) -->
  <section class="hero-section" [ngStyle]="{ '--hero-bg': 'url(' + heroUrl + ')' }">
    <div class="hero-overlay"></div>

    <div class="hero-content shell">
      <div class="hero-breadcrumbs">
        <a routerLink="/bidder/dashboard" class="crumb">
          <span class="dot"></span>
          Home
        </a>
        <mat-icon>chevron_right</mat-icon>
        <a routerLink="/bidder/auctions" class="crumb">
          Auctions
        </a>
        <mat-icon>chevron_right</mat-icon>
        <span class="current">
          {{ auction?.auctionName || ('Auction #' + auctionId) }}
        </span>
      </div>

      <div class="hero-badge">Auction Lots</div>

      <h1 class="hero-title">
        <span class="make">Auction</span>
        <span class="model">{{ auction?.auctionName || ('#' + auctionId) }}</span>
      </h1>

      <div class="hero-meta">
        <div class="meta-pill">
          <mat-icon>inventory_2</mat-icon>
          <span>{{ results.length }} Vehicle{{ results.length !== 1 ? 's' : '' }}</span>
        </div>

        <div class="meta-pill live" *ngIf="isLive">
          <span class="pulse-dot"></span>
          <span>LIVE BIDDING</span>
        </div>

        <div class="meta-pill" *ngIf="scheduledCount > 0 && !isLive">
          <mat-icon>schedule</mat-icon>
          <span>{{ scheduledCount }} Scheduled</span>
        </div>

        <div class="meta-pill muted" *ngIf="endedCount > 0 && !isLive">
          <mat-icon>flag</mat-icon>
          <span>{{ endedCount }} Ended</span>
        </div>
      </div>
    </div>
  </section>

  <!-- ✅ DASHBOARD-LIKE STATS BAR (same rhythm as auctions-list) -->
  <section class="stats-bar" *ngIf="!loading && !error">
    <div class="shell stats-grid">
      <div class="stat-item">
        <div class="stat-value"><span>{{ results.length }}</span></div>
        <div class="stat-label">Visible Vehicles</div>
      </div>

      <div class="stat-item">
        <div class="stat-value"><span>{{ liveCount }}</span></div>
        <div class="stat-label">Live</div>
      </div>

      <div class="stat-item">
        <div class="stat-value"><span>{{ scheduledCount }}</span></div>
        <div class="stat-label">Scheduled</div>
      </div>

      <div class="stat-item">
        <div class="stat-value"><span>{{ endedCount }}</span></div>
        <div class="stat-label">Ended</div>
      </div>
    </div>
  </section>

  <!-- MAIN CONTENT (kept as-is, just placed inside shell like dashboard) -->
  <section class="content-section">
    <div class="shell">
      <!-- Loading -->
      <div class="loader-wrap" *ngIf="loading">
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
        <span>Loading auction vehicles...</span>
      </div>

      <!-- Error -->
      <div class="error-banner" *ngIf="!loading && error">
        <mat-icon>error_outline</mat-icon>
        <span>{{ error }}</span>
      </div>

      <!-- Main Content -->
      <div class="main-content" *ngIf="!loading && !error">
        <!-- Toolbar -->
        <div class="toolbar">
          <div class="search-bar">
            <mat-icon>search</mat-icon>
            <input
              type="text"
              placeholder="Search by make, model, year, chassis..."
              [(ngModel)]="q"
            />
            <button
              *ngIf="q"
              class="clear-btn"
              (click)="q = ''"
              matTooltip="Clear search"
            >
              <mat-icon>close</mat-icon>
            </button>
          </div>

          <div class="filters-row">
            <div class="filter-group">
              <label>Make</label>
              <select [(ngModel)]="filters.make">
                <option value="">All Makes</option>
                <option *ngFor="let m of options.makes" [value]="m">{{ m }}</option>
              </select>
            </div>

            <div class="filter-group">
              <label>Model</label>
              <select [(ngModel)]="filters.model">
                <option value="">All Models</option>
                <option *ngFor="let m of options.models" [value]="m">{{ m }}</option>
              </select>
            </div>

            <div class="filter-group">
              <label>Year</label>
              <select [(ngModel)]="filters.year">
                <option value="">All Years</option>
                <option *ngFor="let y of options.years" [value]="y">{{ y }}</option>
              </select>
            </div>

            <div class="filter-group">
              <label>Category</label>
              <select [(ngModel)]="filters.category">
                <option value="">All Categories</option>
                <option *ngFor="let c of options.categories" [value]="c">{{ c }}</option>
              </select>
            </div>

            <div class="filter-group">
              <label>Sort By</label>
              <select [(ngModel)]="sortBy">
                <option value="newest">Newest First</option>
                <option value="price_low">Price: Low to High</option>
                <option value="price_high">Price: High to Low</option>
                <option value="year_new">Year: Newest</option>
                <option value="year_old">Year: Oldest</option>
              </select>
            </div>

            <button
              class="reset-btn"
              *ngIf="q || filters.make || filters.model || filters.year || filters.category || sortBy !== 'newest'"
              (click)="clearAll()"
            >
              <mat-icon>refresh</mat-icon>
              <span>Reset All</span>
            </button>
          </div>
        </div>

        <!-- Results Count -->
        <div class="results-header">
          <h2>{{ results.length }} Vehicle{{ results.length !== 1 ? 's' : '' }} Available</h2>
          <div class="view-toggle">
            <mat-icon>grid_view</mat-icon>
          </div>
        </div>

        <!-- Vehicle Grid -->
        <div class="vehicle-grid" *ngIf="results.length > 0">
          <article class="vehicle-card" *ngFor="let car of results; trackBy: trackById">
            <!-- Image -->
            <div class="card-image" [ngStyle]="{ '--car-img': 'url(' + car.imageUrl + ')' }">
              <div class="image-overlay"></div>

              <!-- Countdown Badge -->
              <div class="countdown-badge" [ngClass]="car.countdownState">
                <mat-icon>schedule</mat-icon>
                <span>{{ car.countdownText }}</span>
              </div>

              <!-- Favorite Button -->
              <button
                class="fav-btn"
                [class.active]="car.isFavourite"
                (click)="toggleFavourite(car); $event.stopPropagation()"
                matTooltip="{{ car.isFavourite ? 'Remove from favorites' : 'Add to favorites' }}"
              >
                <mat-icon>{{ car.isFavourite ? 'favorite' : 'favorite_border' }}</mat-icon>
              </button>

              <!-- Reserve Met Badge -->
              <div class="reserve-badge" *ngIf="car.reserve != null" [class.met]="car.reserveMet">
                <mat-icon>{{ car.reserveMet ? 'check_circle' : 'info' }}</mat-icon>
                <span>{{ car.reserveMet ? 'Reserve Met' : 'Reserve Not Met' }}</span>
              </div>
            </div>

            <!-- Card Body -->
            <div class="card-body">
              <h3 class="car-title">{{ car.title }}</h3>
              <div class="car-subtitle">{{ car.sub }}</div>

              <!-- Price Grid -->
              <div class="price-grid">
                <!-- Current Bid (Hero) -->
                <div class="price-hero" *ngIf="car.currentPrice != null">
                  <div class="label">Current Bid</div>
                  <div class="value">{{ money(car.currentPrice) }}</div>
                  <div class="your-bid" *ngIf="car.yourMaxBid != null">
                    Your max: <strong>{{ money(car.yourMaxBid) }}</strong>
                  </div>
                </div>

                <!-- Start Price -->
                <div class="price-item" *ngIf="car.auctionStartPrice != null">
                  <div class="label">Start Price</div>
                  <div class="value">{{ money(car.auctionStartPrice) }}</div>
                </div>

                <!-- Buy Now -->
                <div class="price-item" *ngIf="car.buyNow != null">
                  <div class="label">Buy Now</div>
                  <div class="value">{{ money(car.buyNow) }}</div>
                </div>
              </div>

              <!-- Action Buttons -->
              <div class="card-actions">
                <!-- Quick Bid (Primary CTA) -->
                <button
                  class="btn-quick-bid"
                  [disabled]="!isLive || car.placingBid || car.bidCooldownActive"
                  (click)="onQuickBid(car)"
                  matTooltip="Quick bid: Add one increment to current price"
                >
                  <span class="btn-inner">
                    <mat-icon>flash_on</mat-icon>
                    <span *ngIf="!car.bidCooldownActive && !car.placingBid">QUICK BID</span>
                    <span *ngIf="car.bidCooldownActive">PENDING {{ car.bidCooldownRemaining }}s</span>
                    <span *ngIf="car.placingBid">PLACING...</span>
                  </span>
                </button>

                <!-- Secondary Actions -->
                <div class="btn-group">
                  <a
                    class="btn-details"
                    [routerLink]="['/bidder/auctions', auctionId, car.invAuc.inventoryAuctionId, 'details']"
                    matTooltip="View full details"
                  >
                    <mat-icon>description</mat-icon>
                    <span>Details</span>
                  </a>

                  <a
                    class="btn-open"
                    [routerLink]="['/bidder/auctions', auctionId, car.invAuc.inventoryAuctionId]"
                    matTooltip="Open bidding page"
                  >
                    <mat-icon>gavel</mat-icon>
                    <span>Bid</span>
                  </a>
                </div>
              </div>

              <!-- Cooldown Popup -->
              <div class="cooldown-popup" *ngIf="car.bidCooldownActive">
                <div class="cooldown-content">
                  <div class="cooldown-text">
                    <strong>Placing bid in {{ car.bidCooldownRemaining }}s</strong>
                    <span>Click cancel if you've changed your mind</span>
                  </div>
                  <button class="btn-cancel" (click)="cancelQuickBid(car)">Cancel</button>
                </div>
                <div class="cooldown-progress">
                  <div class="progress-fill" [style.width.%]="(car.bidCooldownRemaining || 0) * 20"></div>
                </div>
              </div>
            </div>
          </article>
        </div>

        <!-- Empty State -->
        <div class="empty-state" *ngIf="results.length === 0">
          <mat-icon>search_off</mat-icon>
          <h3>No vehicles match your filters</h3>
          <p>Try adjusting your search criteria or clearing all filters</p>
          <button class="btn-reset" (click)="clearAll()">
            <mat-icon>refresh</mat-icon>
            <span>Reset Filters</span>
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- ✅ DASHBOARD-LIKE FIXED LOADER/ERROR (same as auctions-list) -->
  <div class="page-loader" *ngIf="loading">
    <mat-progress-bar mode="indeterminate"></mat-progress-bar>
  </div>

  <div class="page-error" *ngIf="error && !loading">
    <mat-icon>error_outline</mat-icon>
    <span>{{ error }}</span>
  </div>
</div>
